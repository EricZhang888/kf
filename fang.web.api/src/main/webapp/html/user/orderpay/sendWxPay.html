<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8" />
<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1" />
<meta name="renderer" content="webkit" />
<meta name="viewport"
	content="width=device-width,initial-scale=1.0, minimum-scale=1, maximum-scale=1.0, user-scalable=no,minimal-ui" />
<meta name="apple-mobile-web-app-title" content="1号房公寓" />
<meta name="apple-mobile-web-app-capable" content="yes" />
<meta name="apple-mobile-web-app-status-bar-style" content="black" />
<meta name="robots" content="noindex, nofollow">
<meta name="screen-orientation" content="portrait" />
<meta name="x5-orientation" content="portrait" />
<meta content="telephone=no" name="format-detection" />
<meta name="keywords" content="1号房公寓" />
<meta name="description" content="1号房公寓" />
<title>微信支付</title>
<link rel="stylesheet" href="../../../css/orderpay.css" />

</head>
<body>
	<section class="es_flow" id="orderpay">
		<div class="pay-title">
			<p></p>
		</div>
	</section>
	<aside class="sideBar hide">
		<nav>
			<ul>
				<li><a href="/" class="home">首页</a></li>
				<li id="loginInfoWrap"></li>
			</ul>
		</nav>
	</aside>
	<div class="cfmask" id="cfmask"></div>
</body>
<script type="text/javascript" src="../../../js/jquery-3.1.0.min.js"></script>
<script type="text/javascript" src="../../../js/base.js"></script>
<script type="text/javascript">
	var uri = window.location.search;
	var sPara = parseQuery(uri);

	var appId = sPara.appId;
	var timeStamp = sPara.timeStamp;
	var nonceStr = sPara.nonceStr;
	var pg = sPara.pg;
	var signType = sPara.signType;
	var paySign = sPara.paySign;
	var orderNo = sPara.orderNo;

	function onBridgeReady() {

		WeixinJSBridge.invoke('getBrandWCPayRequest', {
			"appId" : appId, //公众号名称，由商户传入       
			"timeStamp" : timeStamp, //时间戳，自1970年以来的秒数       
			"nonceStr" : nonceStr, //随机串       
			"package" : "prepay_id=" + pg,
			"signType" : signType, //微信签名方式:       
			"paySign" : paySign
		//微信签名   
		},

		function(res) {
			window.location.href = window.g_base.apibase + "/order/pay/wxPayFrontendNotify?msg=" + res.err_msg + "&orderNo=" + orderNo;
		});
	}

	function pay() {

		if (typeof WeixinJSBridge == "undefined") {
			if (document.addEventListener) {
				document.addEventListener('WeixinJSBridgeReady', onBridgeReady,
						false);
			} else if (document.attachEvent) {
				document.attachEvent('WeixinJSBridgeReady', onBridgeReady);
				document.attachEvent('onWeixinJSBridgeReady', onBridgeReady);
			}
		} else {
			onBridgeReady();
		}

	}

	pay();
</script>
</html>